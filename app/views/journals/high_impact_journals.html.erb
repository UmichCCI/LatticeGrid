<script type="text/javascript">
(function($) {
	$(function() {
		// DOM is ready.
		$.configureBoxes({sortBy:'value', transferMode:'copy'});

		// Watch the buttons for click events; update the save button if they are clicked.
		$("#to1, #allTo1, #to2, #allTo2").click(function(event) {
			$('#change_status').text("Changes are NOT saved.");
			$('#change_status').removeClass('ccsg_saved').addClass('ccsg_unsaved');
			$('#high_impact_save').removeAttr('disabled');
			$(this).unbind(event);
		});

		// Check the cookies.  If we have a notice, set it and display the paragraph.
		// Modified from Mozilla: https://developer.mozilla.org/en/DOM/document.cookie
		if (new RegExp("(?:^|;\\s*)" + "ccsg_notice" + "\\s*\\=").test(document.cookie)) {
			var ctext = decodeURIComponent(document.cookie.replace(new RegExp("(?:^|.*;\\s*)" + "ccsg_notice" + "\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*"), "$1"));

			// Interestingly, there isn't any better way to ditch the pluses.
			$('#change_status').text(ctext.replace(/\+/g, ' ')).addClass('ccsg_saved');

			// Also from Mozilla.
			var oExpDate = new Date();
			oExpDate.setDate(oExpDate.getDate() - 1);
			document.cookie = 'ccsg_notice' + "=; expires=" + oExpDate.toGMTString() + "; path=/";
		}
	});
})(jQuery);</script>
<p>Please select the journals that you wish to consider high-impact for all CCSG queries.</p>
<% form_tag set_high_impact_journals_url do %>
	<table>
	<tr>
		<td><h2>All Journals</h2>
			Filter: <input type="text" id="box1Filter" /><button type="button" id="box1Clear">X</button></td>
		<td>&nbsp;</td>
		<td><h2>High-Impact Journals</h2>
			Filter: <input type="text" id="box2Filter" /><button type="button" id="box2Clear">X</button></td>
	</tr>
	<tr>
		<td>
		<select id="box1View" multiple="multiple" style="height:500px;width:300px;font-family:monospace;">
			<% @journals.each do |j| %>
				<option value="<%= j.journal_abbreviation %>" class="<%= 'copiedOption' if j.include_as_high_impact %>">
					<%= "%9s%s%s" % [j.issn, '&nbsp;' * (12 - j.issn.to_s.length), j.journal_abbreviation] %>
				</option>
			<% end %>
		</select><select id="box1Storage"></select>
	</td>
	<td style="vertical-align:top;">
	<!-- <div style="float:left;"> -->
	<p style="margin: 5px 0 20px; text-align:center;"><span id="change_status">No changes.</span><br />
<%= submit_tag "Save", {:disabled => true, :id => 'high_impact_save'} %><%= submit_tag "Restore Defaults" %></p>

	<button id="allTo1" type="button">&nbsp;&lt;&lt;&nbsp;</button>
	<button id="to1" type="button">&nbsp;&lt;&nbsp;</button>
	<button id="to2" type="button">&nbsp;>&nbsp;</button>
	<button id="allTo2" type="button">&nbsp;>>&nbsp;</button>
	<!-- </div> -->
	</td>
	<td>
	<select name="journal_abbrs[]" id="box2View" multiple="multiple" style="height:500px;width:300px;font-family:monospace;">
		<% @journals.each do |j| %>
			<% if j.include_as_high_impact %>
				<option value="<%= j.journal_abbreviation %>">
					<%= "%9s%s%s" % [j.issn, '&nbsp;' * (12 - j.issn.to_s.length), j.journal_abbreviation] %>
				</option>
			<% end %>
		<% end %>
	</select><select id="box2Storage"></select>
	</td>
	</tr>
	<tr>
	<td><span id="box1Counter" class="countLabel"></span></td>
	<td>&nbsp;</td>
	<td><span id="box2Counter" class="countLabel"></span></td>
	</tr>
	</table>
<% end %>
